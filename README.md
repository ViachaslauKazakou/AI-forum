# AI Forum - FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ñ–æ—Ä—É–º–∞

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ñ–æ—Ä—É–º–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –Ω–∞ FastAPI —Å P## üåê –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:

- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: http://localhost:8000
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger)**: http://localhost:8000/docs
- **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞**: http://localhost:8000/topics/create
- **API endpoints**: http://localhost:8000/api/topics
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: http://localhost:8000/admin/
- **Admin API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8000/docs (—Å–µ–∫—Ü–∏—è Admin API)L –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- Poetry (–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)
- Docker –∏ Docker Compose
- Git

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Poetry

```bash
# macOS/Linux
curl -sSL https://install.python-poetry.org | python3 -

# –ò–ª–∏ —á–µ—Ä–µ–∑ pip
pip install poetry
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/ViachaslauKazakou/AI-forum.git
cd AI-forum
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ Poetry

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
poetry install

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
poetry shell
```

### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ PostgreSQL (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)

‚ö†Ô∏è **–í–∞–∂–Ω–æ!** –ï—Å–ª–∏ —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL –Ω–∞ –ø–æ—Ä—Ç—É 5432, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ:

```bash
# –î–ª—è Homebrew –Ω–∞ macOS
brew services stop postgresql

# –î–ª—è systemd –Ω–∞ Linux
sudo systemctl stop postgresql

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
lsof -i :5432
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL

#### –ó–∞–ø—É—Å–∫ PostgreSQL –≤ Docker

```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose up --build -d postgres

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose ps

# –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker-compose logs postgres
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–ø–∞—Ä–æ–ª—å: postgres)
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "\du"
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–§–∞–π–ª `.env` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```env
DATABASE_URL=postgresql+asyncpg://docker:postgres@127.0.0.1:5433/postgres
SECRET_KEY=your-super-secret-key-for-development-only
DEBUG=True
```

### 6. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
poetry run alembic revision --autogenerate -m "Create topics and messages tables"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
poetry run alembic upgrade head

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "\dt"
```

### 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VS Code (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é VS Code:

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
- –§–∞–π–ª—ã `.vscode/settings.json`, `.vscode/tasks.json`, `.vscode/launch.json` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- Python –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `.venv/bin/python`
- –¢–µ—Ä–º–∏–Ω–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

#### –í—ã–±–æ—Ä –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
1. `Cmd+Shift+P` ‚Üí `Python: Select Interpreter`
2. –í—ã–±–µ—Ä–∏—Ç–µ `.venv/bin/python`

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VS Code Tasks:
```
Cmd+Shift+P ‚Üí Tasks: Run Task ‚Üí Install Dependencies (Poetry)
Cmd+Shift+P ‚Üí Tasks: Run Task ‚Üí Run FastAPI (Poetry)
```

### 8. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ó–∞–ø—É—Å–∫ FastAPI —Å–µ—Ä–≤–µ—Ä–∞
poetry run uvicorn app.main:app --reload
```

## üåê –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:

- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: http://localhost:8000
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger)**: http://localhost:8000/docs
- **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞**: http://localhost:8000/topics/create
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: http://localhost:8000/admin/
- **API endpoints**: http://localhost:8000/api/topics

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

#### `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (Primary Key)
- `username` - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ)
- `firstname` - –ò–º—è (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `lastname` - –§–∞–º–∏–ª–∏—è (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `password` - –•–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å (–¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤)
- `email` - Email –∞–¥—Ä–µ—Å (–¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `user_type` - –¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`mentor` –∏–ª–∏ `mentee`)
- `status` - –°—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`pending`, `active`, `disabled`, `archive`, `deleted`)
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

#### `topics` - –¢–µ–º—ã —Ñ–æ—Ä—É–º–∞
- `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (Primary Key)
- `title` - –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–º—ã (–¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)
- `description` - –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–º—ã
- `user_id` - ID –∞–≤—Ç–æ—Ä–∞ —Ç–µ–º—ã (Foreign Key -> users.id)
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `is_active` - –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

#### `messages` - –°–æ–æ–±—â–µ–Ω–∏—è
- `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (Primary Key)
- `content` - –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `author_name` - –ò–º—è –∞–≤—Ç–æ—Ä–∞ (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤)
- `topic_id` - ID —Ç–µ–º—ã (Foreign Key -> topics.id)
- `user_id` - ID –∞–≤—Ç–æ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (Foreign Key -> users.id)
- `parent_id` - ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (Foreign Key -> messages.id, –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤)
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

- **User ‚Üí Topics**: –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ–º (One-to-Many)
- **User ‚Üí Messages**: –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (One-to-Many)
- **Topic ‚Üí Messages**: –û–¥–Ω–∞ —Ç–µ–º–∞ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (One-to-Many)
- **Message ‚Üí Message**: –°–æ–æ–±—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (Self-referencing)

## üê≥ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è PostgreSQL:

- **–û–±—Ä–∞–∑**: postgres:15-alpine
- **–ü–æ—Ä—Ç**: 5433 (–≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º PostgreSQL)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: docker
- **–ü–∞—Ä–æ–ª—å**: postgres
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: postgres

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

PostgreSQL –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã:
- `docker/postgres_db/.docker-env/dev/common.env`
- `docker/postgres_db/.docker-env/dev/postgres.env`

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### VS Code Tasks (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±)

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å VS Code tasks —á–µ—Ä–µ–∑ Poetry. –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ `.vscode/tasks.json`:

#### üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tasks:
1. **–ß–µ—Ä–µ–∑ Command Palette**: `Cmd+Shift+P` ‚Üí `Tasks: Run Task`
2. **–ß–µ—Ä–µ–∑ –º–µ–Ω—é**: `Terminal` ‚Üí `Run Task...`
3. **–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏**: `Cmd+Shift+B` (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ default build task)

#### üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏:

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏:**
- `Install Dependencies (Poetry)` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ Poetry
- `Poetry Shell` - –ê–∫—Ç–∏–≤–∞—Ü–∏—è Poetry shell
- `Poetry Update` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
- `Run FastAPI (Poetry)` - –ó–∞–ø—É—Å–∫ FastAPI —Å–µ—Ä–≤–µ—Ä–∞ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:**
- `Run Tests (Poetry)` - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ pytest
- `Format Code (Poetry)` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ black
- `Lint Code (Poetry)` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞ —á–µ—Ä–µ–∑ flake8

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- `Run Alembic Migration (Poetry)` - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

#### üí° –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```
1. –ü–µ—Ä–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
   - Install Dependencies (Poetry)
   - Run Alembic Migration (Poetry)

2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
   - Run FastAPI (Poetry) (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ)
   - Format Code (Poetry) (–ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º)
   - Run Tests (Poetry)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VS Code

VS Code –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Poetry:
- Python –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –∏–∑ `.venv/bin/python`
- –ê–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ black –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –õ–∏–Ω—Ç–∏–Ω–≥ —á–µ—Ä–µ–∑ flake8 –∏ mypy

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "\dt"

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "\d users"
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "\d topics"
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "\d messages"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "
SELECT 'users' as table_name, COUNT(*) as count FROM users
UNION ALL
SELECT 'topics' as table_name, COUNT(*) as count FROM topics
UNION ALL
SELECT 'messages' as table_name, COUNT(*) as count FROM messages;
"

# —É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres
DROP TABLE table_name;

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ PostgreSQL
docker-compose logs postgres

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker-compose restart postgres

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (—É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
docker-compose down -v
docker-compose up --build -d postgres
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
poetry run alembic revision --autogenerate -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
poetry run alembic upgrade head

# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏
poetry run alembic downgrade -1

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π
poetry run alembic history

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
poetry run alembic current

# –ü—Ä–æ—Å–º–æ—Ç—Ä SQL –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ (–±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
poetry run alembic upgrade head --sql
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ö–µ–º—ã

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–∞–±–ª–∏—Ü–∞–º —Å –¥–∞–Ω–Ω—ã–º–∏ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ—á–∏—Å—Ç–∫–∞:

```bash
# –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "DELETE FROM messages; DELETE FROM topics;"

# –ò–ª–∏ –æ—á–∏—Å—Ç–∫–∞ —Å —Å–±—Ä–æ—Å–æ–º –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "
TRUNCATE TABLE messages, topics RESTART IDENTITY CASCADE;
"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "
SELECT 'topics' as table_name, COUNT(*) as count FROM topics
UNION ALL
SELECT 'messages' as table_name, COUNT(*) as count FROM messages
UNION ALL  
SELECT 'users' as table_name, COUNT(*) as count FROM users;
"
```

### –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
# 1. –°–æ–∑–¥–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
poetry run alembic revision --autogenerate -m "Create users table"

# 2. –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é
poetry run alembic upgrade head

# 3. –°–æ–∑–¥–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–µ–π user_id
poetry run alembic revision --autogenerate -m "Add user_id to topics and messages"

# 4. –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é
poetry run alembic upgrade head
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ NOT NULL –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π –∫ —Ç–∞–±–ª–∏—Ü–∞–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –æ—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª—è nullable.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
poetry add package_name

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
poetry add --group dev package_name

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
poetry update

# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
poetry show
```

## üö¶ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "role 'docker' does not exist"

**–ü—Ä–∏—á–∏–Ω–∞**: –õ–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º

**–†–µ—à–µ–Ω–∏–µ**:
1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL: `brew services stop postgresql`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω: `lsof -i :5432`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker-compose restart postgres`

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused"

**–ü—Ä–∏—á–∏–Ω–∞**: PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ –≥–æ—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs postgres`
3. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å—Ç–∞—Ç—É—Å–∞ "healthy"

### –ü—Ä–æ–±–ª–µ–º–∞: "ModuleNotFoundError: No module named 'dotenv'"

**–ü—Ä–∏—á–∏–Ω–∞**: python-dotenv –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Poetry –æ–∫—Ä—É–∂–µ–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ**:
```bash
poetry add python-dotenv
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Foreign key constraint fails"

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å NOT NULL –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "DELETE FROM messages; DELETE FROM topics;"

# –ò–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–¥–µ–ª–∞–π—Ç–µ –ø–æ–ª–µ nullable –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
# user_id: Mapped[Optional[int]] = mapped_column(ForeignKey("users.id"), nullable=True)
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Table already exists"

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã
poetry run alembic current
poetry run alembic history

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
poetry run alembic stamp head
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ enum —Ç–∏–ø–æ–≤

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ enum —Ç–∏–ø–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `app/models/pydantic_models.py` —Å–æ–¥–µ—Ä–∂–∏—Ç enum —Ç–∏–ø—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–ø–æ—Ä—Ç –≤ `app/models/models.py`:
```python
from app.models.pydantic_models import UserRole, Status
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
AI-forum/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ database.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ crud.py              # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ api.py               # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ web.py               # HTML —Ä–æ—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ models/              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py        # SQLAlchemy –º–æ–¥–µ–ª–∏ (User, Topic, Message)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pydantic_models.py # Pydantic —Å—Ö–µ–º—ã –∏ Enum —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py           # API —Å—Ö–µ–º—ã (deprecated, –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ models/)
‚îÇ   ‚îî‚îÄ‚îÄ templates/           # Jinja2 —à–∞–±–ª–æ–Ω—ã
‚îÇ       ‚îú‚îÄ‚îÄ base.html
‚îÇ       ‚îú‚îÄ‚îÄ index.html
‚îÇ       ‚îú‚îÄ‚îÄ topic.html
‚îÇ       ‚îî‚îÄ‚îÄ create_topic.html
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îî‚îÄ‚îÄ postgres_db/         # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PostgreSQL
‚îÇ       ‚îî‚îÄ‚îÄ .docker-env/
‚îÇ           ‚îî‚îÄ‚îÄ dev/
‚îÇ               ‚îú‚îÄ‚îÄ common.env
‚îÇ               ‚îî‚îÄ‚îÄ postgres.env
‚îú‚îÄ‚îÄ migrations/              # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ versions/           # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ env.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îÇ   ‚îú‚îÄ‚îÄ script.py.mako      # –®–∞–±–ª–æ–Ω –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ README
‚îú‚îÄ‚îÄ docker-compose.yml       # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pyproject.toml          # Poetry –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ alembic.ini             # Alembic –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env                    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env.example            # –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Makefile                # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–µ–º —Ñ–æ—Ä—É–º–∞
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ–º—ã**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ 20 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–µ–º–µ
- **API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–º**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–º
- **API –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL —Å SQLAlchemy –∏ asyncpg
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: FastAPI Templates —Å Jinja2 –∏ Bootstrap
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ç–µ–º–∞–º–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- **CRUD API**: –ü–æ–ª–Ω—ã–π REST API –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: SQLAlchemy 2.0 —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Poetry (–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)
- Docker –∏ docker-compose (–¥–ª—è PostgreSQL)

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <your-repo-url>
cd AI-forum
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```bash
./setup.sh
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
make dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Poetry
```bash
# macOS/Linux
curl -sSL https://install.python-poetry.org | python3 -

# Windows PowerShell
(Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | python -
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
poetry install

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp .env.example .env

# –ó–∞–ø—É—Å–∫ PostgreSQL
docker-compose up -d postgres

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
poetry run python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Makefile

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç Makefile –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```bash
make help          # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
make install       # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make run           # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
make dev           # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å –ë–î)
make test          # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make db-up         # –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
make db-down       # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL
make db-reset      # –°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
make db-logs       # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ PostgreSQL
make format        # –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
make lint          # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥
make type-check    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã
make check         # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
```

## Docker

### PostgreSQL
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π PostgreSQL –≤ Docker:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
docker-compose up -d postgres

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f postgres

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker-compose down

# –°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
docker-compose down -v
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: forum_db
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: forum_user
- **–ü–∞—Ä–æ–ª—å**: forum_password
- **–ü–æ—Ä—Ç**: 5432

```
app/
‚îú‚îÄ‚îÄ __init__.py          # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ main.py             # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ database.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ models.py           # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas.py          # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ crud.py             # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ api.py              # API —Ä–æ—É—Ç—ã
‚îú‚îÄ‚îÄ web.py              # Web —Ä–æ—É—Ç—ã –¥–ª—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü
‚îî‚îÄ‚îÄ templates/          # HTML —à–∞–±–ª–æ–Ω—ã
    ‚îú‚îÄ‚îÄ base.html
    ‚îú‚îÄ‚îÄ index.html
    ‚îú‚îÄ‚îÄ topic.html
    ‚îî‚îÄ‚îÄ create_topic.html
```

## API Endpoints

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `GET /api/admin/users` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /api/admin/users` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/admin/users/{user_id}` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
- `PUT /api/admin/users/{user_id}` - –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /api/admin/users/{user_id}` - –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –¢–µ–º—ã
- `GET /api/topics` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–º
- `GET /api/admin/topics` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–º—ã (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
- `POST /api/admin/topics` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É (—Ç—Ä–µ–±—É–µ—Ç user_id)
- `GET /api/admin/topics/{topic_id}` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–º—É –ø–æ ID
- `PUT /api/admin/topics/{topic_id}` - –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É
- `DELETE /api/admin/topics/{topic_id}` - –£–¥–∞–ª–∏—Ç—å —Ç–µ–º—É
- `GET /api/topics/{topic_id}/messages` - –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–º—ã

### –°–æ–æ–±—â–µ–Ω–∏—è
- `GET /api/admin/messages` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `POST /api/admin/messages` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç–≤–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç user_id)
- `GET /api/admin/messages/{message_id}` - –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ ID
- `PUT /api/admin/messages/{message_id}` - –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- `DELETE /api/admin/messages/{message_id}` - –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

## Web Pages

- `/` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ç–µ–º
- `/topics/{topic_id}` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ–º—ã —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- `/create-topic` - –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Ç–µ–º—ã

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- `/admin/` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- `/admin/users` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/admin/users/create` - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/admin/users/{user_id}/edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/admin/topics` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏
- `/admin/topics/create` - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–µ–º—ã
- `/admin/topics/{topic_id}/edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–º—ã
- `/admin/messages` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- `/admin/messages/{message_id}/edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- `/login` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
- `/register` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª–∏ SQLAlchemy

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤–µ–π—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ SQLAlchemy 2.0:
- `Mapped[Type]` –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–µ–π
- `mapped_column()` –≤–º–µ—Å—Ç–æ `Column()`
- `relationship()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- Enum —Ç–∏–ø—ã –¥–ª—è —Ä–æ–ª–µ–π –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### Enum —Ç–∏–ø—ã

```python
class UserRole(str, PyEnum):
    mentor = "admin"  # –ú–µ–Ω—Ç–æ—Ä (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    mentee = "user"   # –ú–µ–Ω—Ç–∏–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

class Status(str, PyEnum):
    pending = "pending"    # –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    active = "active"      # –ê–∫—Ç–∏–≤–Ω—ã–π
    disabled = "disabled"  # –û—Ç–∫–ª—é—á–µ–Ω
    archive = "archive"    # –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω
    deleted = "deleted"    # –£–¥–∞–ª–µ–Ω
```

### Topics (–¢–µ–º—ã)
- id (Primary Key)
- title (–ù–∞–∑–≤–∞–Ω–∏–µ)
- description (–û–ø–∏—Å–∞–Ω–∏–µ)
- user_id (Foreign Key -> Users, –∞–≤—Ç–æ—Ä —Ç–µ–º—ã)
- created_at (–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è)
- updated_at (–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- is_active (–ê–∫—Ç–∏–≤–Ω–∞—è —Ç–µ–º–∞)

### Messages (–°–æ–æ–±—â–µ–Ω–∏—è)
- id (Primary Key)
- content (–°–æ–¥–µ—Ä–∂–∏–º–æ–µ)
- author_name (–ò–º—è –∞–≤—Ç–æ—Ä–∞)
- topic_id (Foreign Key -> Topics)
- user_id (Foreign Key -> Users, –∞–≤—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è)
- parent_id (Foreign Key -> Messages, –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤)
- created_at (–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è)
- updated_at (–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ `.env`:

```env
DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/forum_db
SECRET_KEY=your-secret-key-here
DEBUG=True
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É:

```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

## –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/amazing-feature`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT.

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub.

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å SQLAlchemy 2.0

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤–µ–π—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ SQLAlchemy:
- `Mapped[Type]` –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–µ–π
- `mapped_column()` –≤–º–µ—Å—Ç–æ `Column()`
- `relationship()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- Enum —Ç–∏–ø—ã –¥–ª—è —Ä–æ–ª–µ–π –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–æ—Ä—É–º–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—è–º–∏
- ‚úÖ –°–≤—è–∑–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ç–µ–º–∞–º–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- ‚úÖ –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
- üîÑ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚è≥ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚è≥ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–≤—Ö–æ–¥–∞
- ‚è≥ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚è≥ –ü–æ–∏—Å–∫ –ø–æ —Ñ–æ—Ä—É–º—É

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ~~–ó–∞–≤–µ—Ä—à–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º user_id –ø–æ–ª–µ–π~~ ‚úÖ
2. ~~–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å~~ ‚úÖ
3. ~~–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD API –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π~~ ‚úÖ
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ JWT
5. –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
6. –û–±–Ω–æ–≤–∏—Ç—å API endpoints –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
7. –î–æ–±–∞–≤–∏—Ç—å –≤–µ–±-—Ñ–æ—Ä–º—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞
8. –í–Ω–µ–¥—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏ –∏–∑ –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "DELETE FROM messages; DELETE FROM topics;"
```

## üêá RabbitMQ + Celery (–±—Ä–æ–∫–µ—Ä –∑–∞–¥–∞—á)

–ù–∏–∂–µ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ RabbitMQ –∫–∞–∫ –±—Ä–æ–∫–µ—Ä–∞ Celery –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –æ—á–µ—Ä–µ–¥–µ–π. –î–æ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã/—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–¥–∞—á —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `tasks` (PostgreSQL), RabbitMQ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –¥–æ—Å—Ç–∞–≤–∫—É –∑–∞–¥–∞—á –≤–æ—Ä–∫–µ—Ä–∞–º.

### 1) –ó–∞–ø—É—Å–∫ RabbitMQ (Docker)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å RabbitMQ —Å –ø–∞–Ω–µ–ª—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (5672 ‚Äî AMQP, 15672 ‚Äî UI)
docker run -d --name rabbitmq \
  -p 5672:5672 -p 15672:15672 \
  -e RABBITMQ_DEFAULT_USER=guest \
  -e RABBITMQ_DEFAULT_PASS=guest \
  rabbitmq:3-management

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω
docker ps --filter name=rabbitmq
```

–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: http://localhost:15672 (–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å: guest/guest)

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å:
```bash
docker stop rabbitmq && docker rm rabbitmq
```

### 2) –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `.env` –¥–æ–±–∞–≤—å—Ç–µ (–∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
```env
RABBITMQ_URL=amqp://guest:guest@localhost:5672//
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ FastAPI –∏ –≤–æ—Ä–∫–µ—Ä –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π `RABBITMQ_URL`.

### 3) –ó–∞–ø—É—Å–∫ Celery-–≤–æ—Ä–∫–µ—Ä–∞

–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ Poetry –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `poetry run`:
```bash
# –í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
poetry run celery -A app.celery_tasks:celery_app worker -l info
```

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∑–∞–¥–∞—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –∏ –∏–º—è –≤–æ—Ä–∫–µ—Ä–∞
```bash
poetry run celery -A app.celery_tasks:celery_app worker -l info -c 4 -n ai-forum@%h
```

### 4) –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á

–≠–Ω–¥–ø–æ–∏–Ω—Ç –∞–¥–º–∏–Ω–∫–∏ —Å—Ç–∞–≤–∏—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å –∏ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `tasks`:
- POST `/admin/messages/ai/create` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `topic_id`, `user_id`

–ü–æ—Ç–æ–∫:
1) FastAPI —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ `tasks` (status=pending)
2) –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ID –∑–∞–ø–∏—Å–∏ –≤ Celery (`process_task.delay(task_id)`)
3) –í–æ—Ä–∫–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å: processing ‚Üí completed/failed

### 5) –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—á–µ—Ä–µ–¥–µ–π –∏ –∑–∞–¥–∞—á

- –í–µ–±-–ø–∞–Ω–µ–ª—å RabbitMQ: http://localhost:15672 ‚Üí Queues ‚Üí –≤–∏–¥–Ω—ã –æ—á–µ—Ä–µ–¥–∏, —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏
- –õ–æ–≥–∏ –≤–æ—Ä–∫–µ—Ä–∞ Celery: —Ç–µ—Ä–º–∏–Ω–∞–ª —Å `celery ... -l info`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã `tasks`:
```bash
PGPASSWORD=postgres psql -h 127.0.0.1 -p 5433 -U docker -d postgres -c "SELECT id, status, started_at, completed_at FROM tasks ORDER BY id DESC LIMIT 20;"
```

### 6) –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –í–æ—Ä–∫–µ—Ä –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è:
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `RABBITMQ_URL`
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 5672 –æ—Ç–∫—Ä—ã—Ç, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω (`docker ps`)
- –ó–∞–¥–∞—á–∏ –Ω–µ –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç—Å—è:
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–æ—Ä–∫–µ—Ä–∞
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º–ø–æ—Ä—Ç `process_task` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (—Å–º. `app/celery_tasks.py`)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
  - –¢–µ–∫—É—â–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Poetry (celery, kombu) –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è RabbitMQ (–∞–ºqp-–¥—Ä–∞–π–≤–µ—Ä —Ç—è–Ω–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ)

### 7) –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã RabbitMQ

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—á–µ—Ä–µ–¥–µ–π —á–µ—Ä–µ–∑ CLI
docker exec -it rabbitmq rabbitmqctl list_queues name messages consumers

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–±–º–µ–Ω–Ω–∏–∫–æ–≤
docker exec -it rabbitmq rabbitmqctl list_exchanges name type

# –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∏–Ω–¥–∏–Ω–≥–æ–≤
docker exec -it rabbitmq rabbitmqctl list_bindings
```
